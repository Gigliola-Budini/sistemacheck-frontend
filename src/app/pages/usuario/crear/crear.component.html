<!-- Start Breadcrumbs -->
<app-breadcrumbs title="Crear Nuevo Usuario" [breadcrumbItems]="breadCrumbItems"></app-breadcrumbs>
<!-- End Breadcrumbs -->

<div class="row">
  <div class="col-lg-12">
      <div class="card">
          <div class="card-body">
            <form action="" [formGroup]="userForm" (ngSubmit)="crearUsuario()">
            <div class="row mt-3">  
                <div class="col-md-6 col-xxl-4">
                    <div class="mb-3">
                        <label class="form-label" for="rut-inp">Rut <i class="text-muted"> - sin puntos y con gui칩n</i></label>
                        <input formControlName="rut" type="text" class="form-control" id="rut-inp" placeholder="Ingrese el RUT ej 11111111-1"[ngClass]="{ 'is-invalid':  f['rut'].invalid  && (f['rut'].dirty || f['rut'].touched)}" required>
                            <div *ngIf="f['rut'].invalid && (f['rut'].dirty || f['rut'].touched)" class="invalid-feedback">
                        
                                <div *ngIf="rut.errors?.['required']">
                                     Debe completar el rut
                                </div>
                                <div *ngIf="f['rut'].errors['notValid'] || f['rut'].errors['minlength']">
                                    El Rut es no es v치lido
                                </div>
                            </div>
                    </div>
                </div>
                <div class="col-md-6 col-xxl-4 ">
                    <div class="mb-3">
                        <label class="form-label" for="project-title-input">Nombre</label>
                        <input formControlName="nombre" type="text" class="form-control" id="project-title-input"
                            placeholder="Ingrese el nombre" [ngClass]="{ 'is-invalid':  f['nombre'].invalid  && (f['nombre'].dirty || f['nombre'].touched)}">
                        <div *ngIf="nombre.invalid && (nombre.dirty || nombre.touched)" class="invalid-feedback">
                            <div *ngIf="f['nombre'].errors['required']">
                                    Debe completar el nombre
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 col-xxl-4">
                    <div class="mb-3">
                        <label class="form-label" for="project-title-input">Primer Apellido </label>
                        <input formControlName="primerApellido" type="text" class="form-control" id="project-title-input"
                            placeholder="Ingrese el primer apellido" [ngClass]="{ 'is-invalid':  primerApellido.invalid  && (primerApellido.dirty || primerApellido.touched)}">
                        <div *ngIf="primerApellido.invalid && (primerApellido.dirty || primerApellido.touched)" class="invalid-feedback">
                            <div *ngIf="primerApellido.errors?.['required']" >
                                    Debe completar el primer apellido
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 col-xxl-4">
                    <div class="mb-3">
                        <label class="form-label" for="project-title-input">Segundo Apellido</label>
                        <input formControlName="segundoApellido" type="text" class="form-control" id="project-title-input"
                            placeholder="Ingrese el segundo apellido" [ngClass]="{ 'is-invalid':  segundoApellido.invalid  && (segundoApellido.dirty || segundoApellido.touched)}">
                            <div *ngIf="segundoApellido.invalid && (segundoApellido.dirty || segundoApellido.touched)" class="invalid-feedback">
                                <div *ngIf="segundoApellido.errors?.['required']">
                                        Debe completar el segundo apellido
                                </div>
                            </div>
                    </div>
                </div>
                <div class="col-md-6 col-xxl-4">
                    <div class="mb-3">
                        <label class="form-label" for="project-title-input">Correo</label>
                        <input formControlName="correo" type="email" class="form-control" id="project-title-input"
                            placeholder="Ingrese el correo" [ngClass]="{ 'is-invalid':  correo.invalid  && (correo.dirty || correo.touched)}"
                            email="true">
                            <div *ngIf="correo.invalid && (correo.dirty || correo.touched)" class="invalid-feedback">
                                <div *ngIf="correo.errors?.['required']">
                                        Debe completar el correo
                                </div>
                                <div *ngIf="correo.errors?.['email']">
                                    El formato del correo no es v치lido
                            </div>
                            </div>
                    </div>
                </div>
                <div class="col-md-6 col-xxl-4">
                    <div class="mb-3">
                        <label class="form-label" for="project-title-input">Confirmar Email</label>
                        <input formControlName="confirmarCorreo" type="email" class="form-control" id="project-title-input"
                            placeholder="Confirme correo" [ngClass]="{ 'is-invalid':  confirmarCorreo.invalid  && (confirmarCorreo.dirty || confirmarCorreo.touched)}">
                            <div *ngIf="confirmarCorreo.invalid && (confirmarCorreo.dirty || confirmarCorreo.touched)" class="invalid-feedback">
                                <div *ngIf="confirmarCorreo.errors?.['required']">
                                        Debe confirmar el correo
                                </div>
                                <div *ngIf="confirmarCorreo.errors?.['email']">
                                    El formato del correo no es v치lido
                            </div>
                            </div>
                    </div>
                </div>
                <div class="col-md-6 col-xxl-4">
                    <div class="mb-3 mb-md-0">
                        <label for="choices-priority-input" class="form-label">Cargo</label>
                        <select class="form-select" formControlName="idRol" [ngClass]="{ 'is-invalid':  idRol.invalid  && (idRol.dirty || idRol.touched)}"
                           >
                           <option value="" selected>Seleccione</option>
                           <option *ngFor="let item of roles" [value]="item.id" >{{item.nombre}}</option>
                        </select>
                        <div *ngIf="idRol.invalid && (idRol.dirty || idRol.touched)" class="invalid-feedback">
                            <div *ngIf="idRol.errors?.['required']">
                                    Debe completar el cargo
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 col-xxl-4">
                    <div class="mb-3 mb-md-0">
                        <label for="choices-priority-input" class="form-label">Servicio de Salud</label>
                        <select formControlName="idServicio" class="form-select" (change)="filtrarControlHospitales()" [ngClass]="{ 'is-invalid':  idServicio.invalid  && (idServicio.dirty || idServicio.touched)}"
                           >
                           <option value="" selected>Seleccione</option>
                           <option *ngFor="let item of serviciosSalud" [value]="item.id">{{item.nombre}}</option>
                           
                        </select>
                        <div *ngIf="idServicio.invalid && (idServicio.dirty || idServicio.touched)" class="invalid-feedback">
                            <div *ngIf="idServicio.errors?.['required']">
                                    Debe seleccionar un Servicio de Salud
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 col-xxl-4">
                    <div class="mb-3 mb-md-0">
                        <label for="choices-priority-input" class="form-label">Centro de Salud</label>
                        <select class="form-select" formControlName="idHospital"  [ngClass]="{ 'is-invalid':  idHospital.invalid  && (idHospital.dirty || idHospital.touched)}"
                           >
                           <option value="" selected>Seleccione</option>
                           <option *ngFor="let item of centrosSalud" [value]="item.idHospital" >{{item.nombreHospital}}</option>
                        </select>
                        <div *ngIf="idHospital.invalid && (idHospital.dirty || idHospital.touched)" class="invalid-feedback">
                            <div *ngIf="idHospital.errors?.['required']">
                                    Debe seleccionar el Centro de salud
                            </div>
                        </div>
                    </div>
                </div>
                
            
            </div>
            <div class="row justify-content-center">
                <div class="col-lg-5 col-md-8  my-4 ">
                   
                        <div class="hstack gap-3 ">
                            <button type="submit" class="btn btn-primary w-50 me-2 ml-2" [disabled]="!userForm.valid || cargando  == true">
                                Crear Usuario
                                <!-- <span class="d-flex align-items-center">
                                    <span class="flex-grow-1 me-2">
                                        Crear Usuario...
                                    </span>
                                    <span class="spinner-border flex-shrink-0" *ngIf="cargando">
                                        <span class="visually-hidden"> Crear Usuario...</span>
                                    </span>
                                </span>    -->
                            
                            </button>
                            <button type="button" [routerLink]="'/usuarios/listar'" class="btn btn-light w-50">Volver</button>
                        </div>
                   
                      <!-- <div class="text-center">
                        
                        <div class="d-grid gap-2 m-2">
                        
                          <button type="button" [routerLink]="'/usuarios/listar'" class="btn btn-light">Volver</button>
                          
                        </div>
                      </div> -->
                </div> 
                <div class="col-xxl-3 col-md-4">
                    
                </div>
               
            </div>


        </form>
            

              
             
          </div>
          <!-- end card body -->
      </div>
      <!-- end card -->

      
  </div>
  
  <!-- end col -->
</div>
<!-- end row -->
